<script>
(function () {
  'use strict';
    var hasOwnProperty = Object.prototype.hasOwnProperty;
    var jQuery = window.jQuery;
    var fn = {};
    // Configurações do helper
    var options = {
      helperName: {{- GTM - Analytics Helper Name}}, // o nome da instância do helper
      dataLayerName: 'dataLayer', // o nome do dataLayer utilizado pelo helper no objeto window do navegador
      debug: ({{Debug Mode}} || false), // o estado do debug mode - true or false
      waitQueue: true, // se os eventos entram na fila (true) ou não (false)
      analyticsUA: ({{dinamyc_GA_UA}} || ''), //a instância do GA que está sendo utilizado para registro dos dados
      containerId: ({{Container ID}} || ''), //o id do container do GTM
      exceptionEvent: 'gtm_dataQuality_event', // o nome do evento que registra as exceções
      exceptionCategory: 'GTM Exception', // a categoria em caso de exceções na execução do código
      customNamePageview: 'ga_pageview', // o nome do trigger de visualizações de página no GTM
      customNameVirtualPageview: 'ga_virtual_pageview', // o nome do trigger de mudanças de páginas em single Apps no GTM
      customNameEvent: 'ga_event',  // o nome do trigger de eventos no GTM
      conversionNameEvent: 'ga_conversion_event',  // o nome do trigger de eventos de conversão no GTM
      customNameTiming: 'ga_timing',
      errorSampleRate: 1,
      gtmCleanup: function (gtmId) {
        helper.setDataLayer('ecommerce', undefined);
        helper.setDataLayer('noInteraction', undefined);
      },
      overwriteHelper: false
    };
  
    var internal = {
      sentPageview: false,
      timingQueue: [],
      eventQueue: []
    };
  
    var helper = {
      internal: internal,
      init: init,
      pageview: pageview,
      virtual_pageview: virtual_pageview,
      event: event,
      conversionEvent: conversionEvent,
      timing: timing,
      sanitize: sanitize,
      debounce: debounce,
      getDataLayer: getDataLayer,
      setDataLayer: setDataLayer,
      cookie: cookie,
      getKey: getKey,
      safeFn: safeFn,
      fn: fn,
      options: options
    };
    function closest(elm, seletor) {
      if ('closest' in elm) return elm.closest(seletor);
      if (typeof jQuery === 'function') return jQuery(elm).closest(seletor)[0];
  
      var parent = elm.parentNode;
  
      while (parent != document) {
        if (matches(parent, seletor)) {
          return parent;
        }
        parent = parent.parentNode;
      }
      return undefined;
    }
  
    function getCookie(key) {
      key = ('; ' + key + '=');
      var cookie = ('; ' + document.cookie);
      var index = cookie.indexOf(key);
      var end;
      if (index === -1) {
        return '';
      }
      cookie = cookie.substring(index + key.length);
      end = cookie.indexOf(';');
      return window.unescape(end === -1 ? cookie : cookie.substring(0, end));
    }
  
    function setCookie(name, value, opts) {
      var exdate, cookie;
      opts = opts || {};
  
      cookie = name + "=" + window.escape(value);
      if (opts.exdays) {
        exdate = new Date();
        exdate.setDate(exdate.getDate() + opts.exdays);
        cookie += "; expires=" + exdate.toUTCString();
      }
      if (opts.domain) {
        cookie += "; domain=" + opts.domain;
      }
      cookie += "; path=" + (opts.path || '/');
      return (document.cookie = cookie);
    }
  
    function cookie(name, value, opts) {
      if (typeof value === 'undefined')
        return getCookie(name);
  
      return setCookie(name, value, opts);
    }
  
    function debounce(func, wait, immediate) {
      var timeout;
      return function() {
        var context = this,
          args = arguments;
        var later = function() {
          timeout = null;
          if (!immediate) func.apply(context, args);
        };
        var callNow = immediate && !timeout;
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
        if (callNow) func.apply(context, args);
      }
    }
  
    function delegate(id, event, selector, oldHandler, parent) {
      var method, elm, handler;
      if (typeof jQuery === 'function') {
        elm = jQuery(parent || document);
        handler = safeFn(id, oldHandler, {
          event: event,
          selector: selector,
          immediate: false
        });
        if (typeof elm.on === 'function') {
          return elm.on(event, selector, handler);
        } else if (typeof elm.delegate === 'function') {
          return elm.delegate(selector, event, handler);
        }
      }
  
      if (typeof parent === 'string') {
        parent = document.querySelectorAll(parent);
      }
  
      if (typeof document.addEventListener === 'function') {
        method = 'addEventListener';
      } else {
        method = 'attachEvent';
        event = 'on' + event;
      }
  
      handler = function(e) {
        for (var target = e.target; target && target !== this; target = target.parentNode) {
          if (matches(target, selector)) {
            var handler = safeFn(id, oldHandler, {
              event: event,
              selector: selector,
              immediate: false
            });
            handler.call(target, e);
            break;
          }
        }
      };
  
      if (Object.prototype.toString.call(parent) === '[object NodeList]') {
        for (var parentIndex = 0; parentIndex <= parent.length - 1; parentIndex++) {
          (parent[parentIndex] || document)[method](event, handler, false);
        }
      } else {
        (parent || document)[method](event, handler, false);
      }
    }
  
    function find(element, selector) {
      return element.querySelectorAll(selector);
    }
  
    function flatten(arrs) {
      var currentArray, currentElement, i, j;
      var result = [];
  
      if (arrs.length === 1) return arrs[0];
  
      while (arrs.length > 0) {
        currentArray = arrs.shift();
        for (i = 0; currentArray.length > i; i++) {
          currentElement = currentArray[i];
          j = 0;
          while (j < result.length && currentElement !== result[j]) {
            j += 1;
          }
          if (j === result.length) result.push(currentElement);
        }
      }
  
      return result;
    }
    function getKey(key, opt_root) {
      if (!key || typeof key !== 'string') return undefined;
  
      var result = opt_root || window;
      var splitKey = key.split('.');
  
      for (var i = 0; i < splitKey.length && result != null; i++) {
        if (has(result, splitKey[i])) {
          result = result[splitKey[i]];
        } else {
          return undefined;
        }
      }
      return result;
    }
  
    function has(obj, key) {
      return hasOwnProperty.call(obj, key);
    }
    function hasClass(e, className) {
      if ('classList' in e) return e.classList.contains(className);
  
      return new RegExp('\\b' + className + '\\b').test(e.className);
    }
  
    function init(opt_options) {
      options = merge(options, opt_options);
      expose();
    }
  
    function internalMap(elms, func, exArgs) {
      var elm, args;
      var ret = [];
      for (var index = 0; index < elms.length; index++) {
        elm = elms[index];
        if (elm instanceof HTMLElement === false) throw 'internalMap: Esperado elemento HTML';
        args = [elm].concat(exArgs);
        ret.push(func.apply(null, args));
      }
      return ret;
    }
  
    function log(type, info, obj) {
      if (options.debug && typeof getKey('console.' + type) === 'function') {
        console[type](info, obj);
      }
    }
  
    function matches(elm, seletor) {
      if ('matches' in elm) return elm.matches(seletor);
      if (typeof jQuery === "function") return jQuery(elm).is(seletor);
  
      var elms = elm.parentNode.querySelectorAll(seletor);
  
      for (var i = 0; i < elms.length; i++) {
        if (elms[i] === elm) {
          return true;
        }
      }
      return false;
    }
  
    function merge(obj, obj2) {
      if (obj2) {
        for (var key in obj2) {
          if (has(obj2, key)) {
            obj[key] = obj2[key];
          }
        }
      }
      return obj;
    }
  
    function on(id, event, selector, oldCallback, parent) {
      var i, array, elm, callback;
  
      if (parent) return delegate(id, event, selector, oldCallback, parent);
  
      callback = safeFn(id, oldCallback, {
        event: event,
        selector: selector,
        immediate: false
      });
  
      if (typeof jQuery === 'function') {
        elm = jQuery(selector);
  
        if (typeof elm.on === 'function') {
          return elm.on(event, callback);
        } else if (typeof elm.bind === 'function') {
          return elm.bind(event, callback);
        }
      }
  
      if (typeof selector === 'string') {
        array = document.querySelectorAll(selector);
      } else if (typeof selector.length === 'undefined' || selector === window) {
        array = [selector];
      } else {
        array = selector;
      }
  
      for (i = 0; i < array.length; i++) {
        elm = array[i];
  
        if (typeof elm.addEventListener === 'function') {
          elm.addEventListener(event, callback);
        } else {
          elm.attachEvent('on' + event, callback);
        }
      }
    }
  
    function reduceBool(arr) {
      var i;
      for (i = 0; i < arr.length; i++) {
        if (arr[i]) return true;
      }
      return false;
    }
  
    function sanitize(str, opts) {
      var split, i, spacer;
  
      if (!str) return '';
      opts = opts || {};
      spacer = typeof opts.spacer === 'string' ? opts.spacer : '_';
  
  
      if (opts && opts.onlyWhiteSpaces) {
        str = str.replace(/^\s+/, '')
          .replace(/\s+$/, '')
          .replace(/\s+/g, '_');
      } else {
        str = str.replace(/^\s+/, '')
          .replace(/\s+$/, '')
          .replace(/\s+/g, '_')
          .replace(/[áàâãåäæª]/g, 'a')
          .replace(/[ÁÀÂÃÅÄÆ]/g, 'A')
          .replace(/[éèêëЄ€]/g, 'e')
          .replace(/[ÉÈÊË]/g, 'E')
          .replace(/[íìîï]/g, 'i')
          .replace(/[ÍÌÎÏ]/g, 'I')
          .replace(/[óòôõöøº]/g, 'o')
          .replace(/[ÓÒÔÕÖØ]/g, 'O')
          .replace(/[úùûü]/g, 'u')
          .replace(/[ÚÙÛÜ]/g, 'U')
          .replace(/[ç¢©]/g, 'c')
          .replace(/[Ç]/g, 'C')
          .replace(/[^a-zA-Z0-9_\-]/g, '_');
      }
  
      if (opts && opts.caseMode) {
        switch (opts.caseMode) {
          case "capitalized":
            split = str.replace(/^_+|_+$/g, '').split(/_+/g);
            for (i = 0; i < split.length; i++) {
              if (split[i]) split[i] = split[i][0].toUpperCase() + split[i].slice(1);
            }
            return split.join(spacer);
            break;
          case "lowercase":
            str = str.toLowerCase();
            break;
          case "uppercase":
            str = str.toUpperCase();
            break;
          default:
            break;
        }
      }
  
      return str.replace(/^_+|_+$/g, '').replace(/_+/g, spacer);
    }
  
    function text(elm, opts) {
      var i, text, children;
      opts = opts || {};
  
      if (opts.onlyFirst) {
        children = elm.childNodes;
        text = '';
  
        for (i = 0; i < children.length; i++) {
          if (children[i].nodeType === 3) {
            text += children[i].nodeValue;
          }
        }
      } else {
        text = elm.innerText || elm.textContent || elm.innerHTML.replace(/<[^>]+>/g, '');
      }
  
      return opts.sanitize ? sanitize(text, opts.sanitize) : text;
    }
  
    function conversionEvent(category, action, label, value, object, sanitizedBefore, id) {
      try {
        if (internal && internal.sentPageview === false && options.waitQueue) {
          log('Info', 'The event (' + arguments + ') has been add to the queue');
          return internal.eventQueue.push(arguments);
        }
  
        if (value != null && typeof value === 'object') {
          object = value;
          value = undefined;
        } else {
          object = object || {};
        }
  
        var result = {
          event: options.conversionNameEvent,
          eventCategory: category,
          eventAction: action,
          eventValue: value,
          eventLabel: sanitizedBefore ? label : helper.sanitize(label, {
            spacer: ' ',
            onlyWhiteSpaces: true
          }),
          _tag: id
        };
  
        if (options.gtmCleanup) {
          result.eventCallback = options.gtmCleanup;
        }
  
        log('info', result, object);
        window[options.dataLayerName].push(merge(result, object));
      } catch (err) {
        log('warn', err);
      }
    }
  
    function getDataLayer(key) {
      try {
        return google_tag_manager[options.containerId].dataLayer.get(key);
      } catch ($$e) {
        log('warn', 'Function getDataLayer: Object ' + key + ' is not defined');
      }
    }
  
    function setDataLayer(key, value) {
      try {
        return google_tag_manager[options.containerId].dataLayer.set(key, value);
      } catch ($$e) {
        log('warn', $$e);
      }
    }
  
  
    function event(category, action, label, value, object, sanitizedBefore, id) {
      try {
        if (internal && internal.sentPageview === false && options.waitQueue) {
          log('Info', 'The event (' + arguments + ') has been add to the queue');
          return internal.eventQueue.push(arguments);
        }
  
        if (value != null && typeof value === 'object') {
          object = value;
          value = undefined;
        } else {
          object = object || {};
        }
  
        var result = {
          event: options.customNameEvent,
          eventCategory: category,
          eventAction: action,
          eventValue: value,
          eventLabel: sanitizedBefore ? label : helper.sanitize(label, {
            spacer: ' ',
            onlyWhiteSpaces: true
          }),
          _tag: id
        };
  
        if (options.gtmCleanup) {
          result.eventCallback = options.gtmCleanup;
        }
  
        log('info', result, object);
        window[options.dataLayerName].push(merge(result, object));
      } catch (err) {
        log('warn', err);
      }
    }
  
    function localHelperFactory(conf) {
      var localHelper = {
        event: function(category, action, label, value, object, sanitizedBefore) {
          return event(category, action, label, value, object, sanitizedBefore, conf.id);
        },
        conversionEvent: function(category, action, label, value, object, sanitizedBefore) {
          return conversionEvent(category, action, label, value, object, sanitizedBefore, conf.id);
        },
        pageview: function(path, object) {
          return pageview(path, object, conf.id);
        },
        virtual_pageview: function(path, object) {
          return virtual_pageview(path, object, conf.id);
        },
        timing: function(category, variable, value, label, object) {
          return timing(category, variable, value, label, object, conf.id);
        },
        safeFn: function(id, callback, opts) {
          return safeFn(conf.id, callback, opts);
        },
        on: function(event, selector, callback, parent) {
          return on(conf.id, event, selector, callback, parent);
        },
        delegate: function(event, selector, callback) {
          return on(conf.id, event, selector, callback, document.body);
        },
        wrap: function(elm) {
          if (typeof elm === 'string') {
            elm = find(window.document, elm);
          } else if (elm instanceof HTMLElement) {
            elm = [elm];
          } else if ((elm instanceof Array || elm instanceof NodeList) === false) {
            throw 'wrap: Esperado receber seletor, elemento HTML, NodeList ou Array';
          }
  
          return {
            hasClass: function(className, opts) {
              var arr = internalMap(elm, hasClass, [className]);
              return (opts && opts.toArray) ? arr : reduceBool(arr);
            },
            matches: function(selector, opts) {
              var arr = internalMap(elm, matches, [selector]);
              return (opts && opts.toArray) ? arr : reduceBool(arr);
            },
            closest: function(selector) {
              return localHelper.wrap(internalMap(elm, closest, [selector]));
            },
            text: function(opts) {
              var arr = internalMap(elm, text, [opts]);
              return (opts && opts.toArray) ? arr : arr.join('');
            },
            find: function(sel) {
              var elms = internalMap(elm, find, [sel]);
              return localHelper.wrap(flatten(elms));
            },
            map: function(func, params) {
              return internalMap(elm, func, params);
            },
            on: function(event, parent, callback) {
              if (typeof parent === "function") {
                on(conf.id, event, elm, parent);
              } else {
                on(conf.id, event, parent, callback, elm);
              }
            },
            nodes: elm
          };
        },
        sanitize: sanitize,
        debounce: debounce,
        getDataLayer: getDataLayer,
        setDataLayer: setDataLayer,
        cookie: cookie,
        getKey: getKey,
        id: conf.id,
        args: conf.args,
        fn: fn,
        _event: conf.event,
        _selector: conf.selector
      };
      return localHelper;
    }
    function pageview(path, object, id) {
      try {
        var result = {
          event: options.customNamePageview,
          path: path,
          _tag: id
        };
  
        if (options.gtmCleanup) {
          result.eventCallback = options.gtmCleanup;
        }
  
        log('info', result, object);
        window[options.dataLayerName].push(merge(result, object));
      } catch (err) {
        log('warn', err);
      }
    }
  
    function safeFn(id, callback, opt) {
      opt = opt || {};
      var safe = function() {
        try {
          callback.call(this === window ? null : this, localHelperFactory({
            id: id,
            args: arguments,
            event: (typeof opt.event === "string" && opt.event || undefined),
            selector: (typeof opt.selector === "string" && opt.selector || undefined)
          }));
        } catch ($$e) {
          if (!options.debug) {
            if (Math.random() <= options.errorSampleRate) {
              window[options.dataLayerName].push({
                event: options.exceptionEvent,
                dataQuality: {
                  category: options.exceptionCategory,
                  action: id,
                  label: String($$e),
                  event: (typeof opt.event === "string" && opt.event || undefined),
                  selector: (typeof opt.selector === "string" && opt.selector || undefined)
                }
              });
            }
          } else {
            log('warn', 'Exception: ', {
              exception: $$e,
              tag: id,
              event: (typeof opt.event === "string" && opt.event || undefined),
              selector: (typeof opt.selector === "string" && opt.selector || undefined)
            });
          }
        }
      };
  
      return opt.immediate === false ? safe : safe();
    }
    internal.timingQueue = [];
  
    function timing(category, variable, value, label, object, id) {
      try {
        if (internal && internal.sentPageview === false && options.waitQueue) {
          log('Info', 'The timing event (' + arguments + ') has been add to the queue');
          return internal.timingQueue.push(arguments);
        }
  
        object = object || {};
  
        var result = {
          event: options.customNameTiming,
          timingCategory: category,
          timingVariable: variable,
          timingValue: value,
          timingLabel: label,
          _tag: id
        };
  
        if (options.gtmCleanup) {
          result.eventCallback = options.gtmCleanup;
        }
  
        log('info', result, object);
        window[options.dataLayerName].push(merge(result, object));
      } catch (err) {
        log('warn', err);
      }
    }
  
    function virtual_pageview(path, object, id) {
      try {
        var result = {
          event: options.customNameVirtualPageview,
          path: path,
          _tag: id
        };
  
        if (options.gtmCleanup) {
          result.eventCallback = options.gtmCleanup;
        }
        log('info', result, object);
        window[options.dataLayerName].push(merge(result, object));
      } catch (err) {
        log('warn', err);
      }
    }
  function expose() {
    if (window[options.helperName] && !options.overwriteHelper) return;
    window[options.helperName] = helper;
  }
  
  expose();
}());
</script>